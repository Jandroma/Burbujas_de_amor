<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Rompeburbuja de Amor</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { height: 100%; overflow: hidden; background: linear-gradient(#ffccff, #ffe6f2); font-family: sans-serif; }
    canvas { display: block; background: transparent; }

    .controls {
      position: absolute;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: center;
      gap: 15px;
      pointer-events: none;
    }

    .btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: pink;
      border: 2px solid red;
      text-align: center;
      line-height: 60px;
      font-size: 30px;
      user-select: none;
      pointer-events: all;
    }

    #marcador {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 24px;
      color: #b30059;
      background: rgba(255, 255, 255, 0.7);
      padding: 5px 15px;
      border-radius: 10px;
    }

    #mensaje {
      position: absolute;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 36px;
      color: #e60073;
      display: none;
      text-align: center;
    }
  </style>
</head>
<body>
  <canvas id="juego"></canvas>
  <div id="marcador">Letras: _ _ _ _</div>
  <div id="mensaje"></div>
  <div class="controls">
    <div class="btn" id="left">&#8592;</div>
    <div class="btn" id="shoot">&#10084;</div>
    <div class="btn" id="right">&#8594;</div>
  </div>

  <script>
    const canvas = document.getElementById("juego");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let heart = { x: canvas.width/2, y: canvas.height - 80, r: 25, vx: 0 };
    let bullets = [];
    let letters = [];
    const palabraObjetivo = ["A", "L", "E", "X"];
    let letrasObtenidas = [];

    let keys = { left: false, right: false };

    document.getElementById("left").addEventListener("touchstart", () => keys.left = true);
    document.getElementById("left").addEventListener("touchend", () => keys.left = false);
    document.getElementById("right").addEventListener("touchstart", () => keys.right = true);
    document.getElementById("right").addEventListener("touchend", () => keys.right = false);

    document.getElementById("shoot").addEventListener("touchstart", () => {
      bullets.push({ x: heart.x, y: heart.y - 30 });
    });

    function crearLetra() {
      const posibles = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      const letra = posibles[Math.floor(Math.random() * posibles.length)];
      letters.push({
        letra,
        x: Math.random() * (canvas.width - 30),
        y: -50,
        size: 30
      });
    }

    function dibujarCorazon() {
      ctx.fillStyle = "#ff3366";
      ctx.beginPath();
      ctx.moveTo(heart.x, heart.y);
      ctx.bezierCurveTo(heart.x + 25, heart.y - 25, heart.x + 50, heart.y + 20, heart.x, heart.y + 50);
      ctx.bezierCurveTo(heart.x - 50, heart.y + 20, heart.x - 25, heart.y - 25, heart.x, heart.y);
      ctx.fill();
    }

    function dibujar() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Mover corazón
      if (keys.left) heart.x -= 5;
      if (keys.right) heart.x += 5;
      heart.x = Math.max(heart.r, Math.min(canvas.width - heart.r, heart.x));

      // Dibujar corazón
      dibujarCorazon();

      // Dibujar balas
      ctx.fillStyle = "#ff6699";
      bullets.forEach((b, i) => {
        b.y -= 8;
        ctx.beginPath();
        ctx.arc(b.x, b.y, 5, 0, Math.PI * 2);
        ctx.fill();
        if (b.y < 0) bullets.splice(i, 1);
      });

      // Letras
      ctx.fillStyle = "#660033";
      letters.forEach((l, i) => {
        l.y += 2;
        ctx.font = `${l.size}px sans-serif`;
        ctx.fillText(l.letra, l.x, l.y);

        // Colisión con bala
        bullets.forEach((b, bi) => {
          if (Math.abs(l.x - b.x) < 20 && Math.abs(l.y - b.y) < 20) {
            if (palabraObjetivo.includes(l.letra) && !letrasObtenidas.includes(l.letra)) {
              letrasObtenidas.push(l.letra);
              actualizarMarcador();
              if (letrasObtenidas.length === palabraObjetivo.length) {
                document.getElementById("mensaje").innerHTML = "CORAZÓN<br>ÁLEX<br><br><small>By Jandro</small>";
                document.getElementById("mensaje").style.display = "block";
              }
            }
            letters.splice(i, 1);
            bullets.splice(bi, 1);
          }
        });

        if (l.y > canvas.height) letters.splice(i, 1);
      });
    }

    function actualizarMarcador() {
      const estado = palabraObjetivo.map(l => letrasObtenidas.includes(l) ? l : "_").join(" ");
      document.getElementById("marcador").textContent = "Letras: " + estado;
    }

    setInterval(crearLetra, 1500);
    function animar() {
      dibujar();
      requestAnimationFrame(animar);
    }
    animar();
  </script>
</body>
</html>
